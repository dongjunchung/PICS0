{
    "collab_server" : "",
    "contents" : "% -*- mode: noweb; noweb-default-code-mode: R-mode; -*-\n\\documentclass[11pt]{article}\n%% Set my margins\n\\setlength{\\oddsidemargin}{0.0truein}\n\\setlength{\\evensidemargin}{0.0truein}\n\\setlength{\\textwidth}{6.5truein}\n\\setlength{\\topmargin}{0.0truein}\n\\setlength{\\textheight}{9.0truein}\n\\setlength{\\headsep}{0.0truein}\n\\setlength{\\headheight}{0.0truein}\n\\setlength{\\topskip}{0pt}\n%% End of margins\n\n%%\\pagestyle{myheadings}\n%%\\markboth{$Date$\\hfil$Revision$}{\\thepage}\n\n\\usepackage[pdftex,\nbookmarks,\nbookmarksopen,\npdfauthor={Zequn Sun, Dongjun Chung and Wei Wei},\npdftitle={PICS Vignette}]\n{hyperref}\n\n\n\\title{An Introduction to the `\\texttt{PICS}' Package, Version 1.0}\n\\author{Zequn Sun$^1$, Dongjun Chung$^1$ and S\\\"und\\\"uz Kele\\c{s}$^{1,2}$\\\\\n  $^1$Department of Statistics, University of Wisconsin\\\\\n  Madison, WI 53706.\\\\\n  $^2$Department of Biostatistics and Medical Informatics, University of Wisconsin\\\\\n  Madison, WI 53706.}\n\n\\date{\\today}\n\n\\SweaveOpts{engine=R, echo=TRUE, pdf=TRUE}\n\n\\begin{document}\n\\SweaveOpts{concordance=TRUE}\n%\\VignetteIndexEntry{Sparse PLS}\n%\\VignetteKeywords{PLS, Sparse PLS}\n%\\VignettePackage{spls}\n\\maketitle\n\n\\section{Overview}\n\nThis vignette provides basic information about the\n`\\texttt{spls}' package. SPLS stands for ``Sparse Partial Least Squares''.\nThe  SPLS regression methodology is developed in \\cite{spls}. The main principle of this methodology is\nto impose sparsity within the context of partial least squares and thereby carry out  dimension\nreduction and variable selection simultaneously. SPLS regression exhibits good performance even when\n(1) the sample size is much smaller than the total number of variables; and\n(2) the covariates are highly correlated. One additional advantage of SPLS regression is\nits ability to handle both univariate and multivariate responses.\n\nThe package can be loaded with the command:\n\n<<preliminaries,echo=FALSE,results=hide>>=\noptions(prompt = \"R> \")\n@\n\n<<spls-prelim,results=hide>>=\nlibrary(\"spls\")\n@\n\n\\section{Input Data}\n\nThe package requires that the response is given in the form of a either vector or matrix, and\nthe predictors in the form of a matrix. The response can be either univariate or multivariate.\nThe responses and the predictors are assumed to be numerical and should not contain missing values.\nAs part of pre-processing, the predictors are centered and scaled and the responses are\ncentered automatically as default by the package `\\texttt{spls}'.\n\nWe provide the Yeast Cell Cycle dataset as an example application for the `\\texttt{spls}' package.\nThe responses are the cell cycle gene expression data of 542 genes \\cite{cycle}\nfrom an $\\alpha$ factor based experiment. In this experiment, mRNA levels were measured at every 7 minute during 119\nminutes. Hence, the response has a total of 18 measurements covering two cell cycle periods.\nThese 18 measurements correspond to 18 columns of the response matrix  in the dataset.\nThe predictors are chromatin immunoprecipitation on chip (ChIP-chip) data of \\cite{chip}\nand they contain the binding information for 106 transcription factors (TF).\nThis application is concerned with identifying cell cycle\nrelated TFs, i.e., TFs whose binding events contribute to explaining the variability in gene expression,\nas well as inferring their activities. See \\cite{spls} for more details.\n\nThe yeast cell cycle dataset with the `\\texttt{y}' matrix\nas the cell cycle gene expression (responses) and the `\\texttt{x}' matrix as the\nChIP-chip data (predictors) can be loaded as follows:\n\n<<spls-data>>=\ndata(yeast)\nyeast$x[1:5,1:5]\nyeast$y[1:5,1:5]\n@\n\n\\section{Tuning Parameters}\n\\texttt{SPLS} regression has two main tuning parameters: `\\texttt{eta}' represents\nthe sparsity tuning parameter and `\\texttt{K}'\nis the number of hidden (latent) components. Parameters can be chosen by ($v$-fold)\ncross-validation using the\nfunction `\\texttt{cv.spls}'.  The user specifies the range for these parameters and\nthe cross-validation procedure\nsearches within these ranges. `\\texttt{eta}' should have a value between 0 and 1. `\\texttt{K}'\nis integer valued and can range between\n1 and $ min \\left\\{ p, (v-1) n / v \\right\\} $, where $p$ is the number of predictors and $n$ is the sample size. For example, if 10-fold cross-validation is used (default), `\\texttt{K}' should be smaller than $ min \\left\\{ p, 0.9 n \\right\\} $. For the yeast data, we search for `\\texttt{K}' between 5 and 10 and for `\\texttt{eta}' between 0.1 and 0.9\nwith the following command:\n\n<<plot1,eval=FALSE>>=\nset.seed(1)\ncv <- cv.spls( yeast$x, yeast$y, eta = seq(0.1,0.9,0.1), K = c(5:10) )\n@\n\n`\\texttt{cv.spls}' returns a heatmap-type plot of mean squared prediction error (MSPE)\nand the optimal values for  `\\texttt{eta}' and `\\texttt{K}'. MSPE plot is given in Figure \\ref{fig:cv}\nand `\\texttt{cv.spls}' recommends to use `\\texttt{eta}=0.7' and `\\texttt{K}=8'.\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<cv,fig=TRUE,height=6,width=6,echo=FALSE,results=hide>>=\n<<plot1>>\n@\n\\caption{\\label{fig:cv} MSPE plot of SPLS when eta = 0.1--0.9 and K = 5--10.}\n\\end{center}\n\\end{figure}\n\n\\section{\\texttt{SPLS} Fit}\nUsing the parameters obtained from `\\texttt{cv.spls}', \\texttt{SPLS} can be fitted\nby the function `\\texttt{spls}'. `\\texttt{spls}' also prints out the variables\nthat join the set of selected variables at each iteration step of SPLS fit.\n`\\texttt{print.spls}' displays\nthe parameters used, the number of selected predictors, and the list of the\nselected predictors. `\\texttt{coef.spls}' prints out the coefficient estimates of SPLS fits.\n\n<<spls-fn>>=\nf <- spls( yeast$x, yeast$y, eta = cv$eta.opt, K = cv$K.opt )\nprint(f)\ncoef.f <- coef(f)\ncoef.f[1:5,1:5]\n@\n\nA plot that illuminates the fitting procedure is the\ncoefficient path plot given in Figure \\ref{fig:plot}. This plot illustrates how the\ncoefficient estimates change as a function of `\\texttt{K}' for a given `\\texttt{eta}'.\nThe coefficient path plot for a specific value of `\\texttt{eta}' can be obtained  using the function\n`\\texttt{plot.spls}'. When there are many responses,\nit might not be a good idea to plot them all together.\nThe response of interest can be defined with the option `\\texttt{yvar}'.\nIf the option `\\texttt{yvar}' is not specified,\nthen `\\texttt{plot.spls}' draws the coefficient paths\nof all responses. The command below generates the coefficient path plot given in Figure\n\\ref{fig:plot}.\n\n<<plot2,eval=FALSE>>=\nplot.spls( f, yvar=1 )\n@\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<plot,fig=TRUE,height=6,width=6,echo=FALSE>>=\n<<plot2>>\n@\n\\caption{\\label{fig:plot} Coefficient path plot of the SPLS fit for the yeast data when eta=0.7.}\n\\end{center}\n\\end{figure}\n\nIn the yeast cell cycle data, the responses were repeatedly measured at different time points.\nIn this case, it is useful to visualize how the estimated coefficients\nchange as a function of time. The function `\\texttt{coefplot.spls}'\nplots the estimated coefficients of the fit obtained from the `\\texttt{spls}' function across\nall the responses. By default, `\\texttt{coefplot.spls}' displays the estimated coefficients of\nthe selected predictors. However, in the case\nthat too many predictors are chosen, this might lead to a  crowded plotting area.\nWe provide  two options to avoid this. First, one  can choose predictors\nto be plotted by the option `\\texttt{xvar}'. Note that the index number here is defined\namong the selected variables. For example, `\\texttt{xvar = 1}' refers to  the first variable\namong the selected predictors. In this  example, `\\texttt{xvar}' can be\n between 1 and 28. Second, one can also control the number of plots\nthat appear in each window using the option `\\texttt{nwin}'. For example,\n`\\texttt{nwin = c(2,2)}' indicates that the plotting area will have 4 plots with\ntwo rows and two columns. An illustration of this plotting option is given below and the\nresulting plots are displayed in Figure \\ref{fig:coef}.\n\n<<plot3,eval=FALSE>>=\ncoefplot.spls( f, nwin=c(2,2), xvar=c(1:4) )\n@\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<coef,fig=TRUE,height=6,width=6,echo=FALSE>>=\n<<plot3>>\n@\n\\caption{\\label{fig:coef} Plot of the estimated coefficients.}\n\\end{center}\n\\end{figure}\n\n\\section{eQTL Application}\n\nIn this section, we study the application of SPLS regression\nto the expression quantitative trait loci (eQTL) mapping.\nWe provide the mice dataset \\cite{mice} as an example\nof the eQTL application. Mice were collected from a \\textit{$F_2$-ob/ob} cross and\nlacked a functional leptin protein hormone. The functional leptin protein hormone\nis known to be important for reproduction and regulation of body weight and metabolism.\nThe predictors are\nthe marker map consisting of 145 microsatellite markers from 19 non-sex mouse chromosomes.\nThe responses are the gene expression measurements of 83 transcripts\nfrom liver tissues of 60 mice. This group of 83 transcripts was obtained\nas one of the clusters, when 45,265 transcripts were clustered using a hierarchical\nclustering approach. See \\cite{eqtl} for more details.\n\nThe mice dataset with the `\\texttt{y}' matrix as the gene expression (responses) and\nthe `\\texttt{x}' matrix as the marker map (predictors) can be loaded as follows:\n\n<<eqtl-data>>=\ndata(mice)\nmice$x[1:5,1:5]\nmice$y[1:5,1:5]\n@\n\nThe optimal parameters were chosen as `\\texttt{eta=0.6}' and `\\texttt{K=1}'\nfrom `\\texttt{cv.spls}' as follows.\n\n<<eqtl-cv, eval=FALSE>>=\nset.seed(1)\ncv <- cv.spls( mice$x, mice$y, eta = seq(0.1,0.9,0.1), K = c(1:5) )\n@\n\nSPLS fits are obtained as below.\n\n<<eqtl-fn, eval=FALSE>>=\nf <- spls( mice$x, mice$y, eta = cv$eta.opt, K = cv$K.opt )\nprint(f)\n@\n\n<<eqtl-fn, echo=FALSE>>=\nf <- spls( mice$x, mice$y, eta = 0.6, K = 1 )\nprint(f)\n@\n\nIn this eQTL analysis, we can improve the initial SPLS fits further\nas described in \\cite{eqtl}.\nFirst, we obtain the bootstrapped confidence intervals\nfor the coefficients of the selected predictors using the function `\\texttt{ci.spls}'.\n`\\texttt{ci.spls}' also provides the confidence interval plots and\nlets users to control the plots with two options, `\\texttt{plot.fix}' and `\\texttt{plot.var}'.\nIf `\\texttt{plot.fix=\"x\"}', then the function `\\texttt{ci.spls}' plots the confidence intervals\nof a given predictor specified by the option `\\texttt{plot.var}' across all the responses.\nSimilarly, `\\texttt{plot.fix=\"y\"}' draws the plot against the predictors for the given responses.\nNote that if `\\texttt{plot.fix=\"x\"}', then the index number is defined among the selected variables.\nFigure \\ref{fig:ciplot} shows the confidence interval plot of the coefficients.\n\n<<plot5,eval=FALSE>>=\nset.seed(1)\nci.f <- ci.spls( f, plot.it=TRUE, plot.fix='x', plot.var=20 )\n@\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<ciplot,fig=TRUE,height=6,width=6,echo=FALSE,results=hide>>=\n<<plot5>>\n@\n\\caption{\\label{fig:ciplot} Example plot of the confidence intervals of the coefficients.}\n\\end{center}\n\\end{figure}\n\nThe function `\\texttt{ci.spls}' returns the list whose\nelement is the matrix of the confidence intervals\nof the coefficients. The names of elements of the\nlist are the same as the column names of the responses.\n\n<<eqtl-ci>>=\ncis <- ci.f$cibeta\ncis[[20]][1:5,]\n@\n\nAfter we obtain the confidence intervals of the coefficients,\nthe function `\\texttt{correct.spls}' updates the coefficient estimates\nof the selected variables by setting the coefficients with zero-containing\nconfidence intervals to zero.\nIn addition, `\\texttt{correct.spls}' provides the heatmap-type plots\nof the original SPLS coefficient estimates (Figure \\ref{fig:coef1})\nand the corrected coefficient estimates (Figure \\ref{fig:coef2}).\n\n<<cor1,eval=FALSE>>=\ncf <- correct.spls( ci.f )\n@\n\n<<cor2,echo=FALSE>>=\ncf <- correct.spls( ci.f, plot.it=FALSE )\n@\n\n<<cor-out>>=\ncf[15:20,1:5]\n@\n\n<<plot6,echo=FALSE,eval=FALSE>>=\nheatmap.spls( mat=f$betahat, xlab='Predictors', ylab='Responses',\n            main='Original Coefficient Estimates', coln=16, as='i' )\n@\n\n<<plot7,echo=FALSE,eval=FALSE>>=\nheatmap.spls( mat=cf, xlab='Predictors', ylab='Responses',\n            main='Corrected Coefficient Estimates', coln=16, as='i' )\n@\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<coef1,fig=TRUE,height=6,width=6,echo=FALSE>>=\n<<plot6>>\n@\n\\caption{\\label{fig:coef1} Plot of the original coefficient estimates.}\n\\end{center}\n\\end{figure}\n\n\\begin{figure}[tbh]\n\\begin{center}\n<<coef2,fig=TRUE,height=6,width=6,echo=FALSE>>=\n<<plot7>>\n@\n\\caption{\\label{fig:coef2} Plot of the corrected coefficient estimates.}\n\\end{center}\n\\end{figure}\n\n\\begin{thebibliography}{99}\n\\bibitem{spls} Chun, H. and Kele\\c{s}, S. (2007) ``Sparse partial least squares\n  for simultaneous dimension reduction and variable selection'',\n(\\url{http://www.stat.wisc.edu/~keles/Papers/SPLS_Nov07.pdf}).\n\\bibitem{eqtl} Chun, H. and Kele\\c{s}, S. (2008). ``Expression quantitative trait loci mapping\nwith multivariate sparse partial least squares regression\",\n(\\url{http://www.stat.wisc.edu/~keles/Papers/chun_keles_eQTL_SPLS_submit.pdf}).\n\\bibitem{mice} Lan, H., M. Chen, J. B. Flowers, B. S. Yandell, D. S. Stapleton, C. M. Mata,\nE. T-K Mui, M. T. Flowers, K. L. Schueler, K. F. Manly, R. W. Williams,\nC. Kendziorski, and A. D. Attie (2006). ``Combined expression\ntrait correlations and expression quantitative trait locus mapping\", \\textit{PLoS\nGenetics}, 2, e6.\n\\bibitem{chip} Lee, T. I., N. J. Rinaldi, F. Robert, D. T. Odom, Z. Bar-Joseph, G. K. Gerber,\nN. M. Hannett, C. T. Harbison, C. M. Thomson, I. Simon, J. Zeitlinger, E. G.\nJennings, H. L. Murray, D. B. Gordon, B. Ren, J. J. Wyrick, J.-B. Tagne,\nT. L. Volkert, E. Fraenkel, D. K. Gifford, and R. A. Young (2002). ``Transcriptional\nregulatory networks in \\textit{Saccharmomyces cerevisiae}\". \\textit{Science}, \\textbf{298}, pp. 799--804.\n\\bibitem{cycle} Spellman, P. T., G. Sherlock, M. Q. Zhang, V. R. Iyer, K. Anders, M. B. Eisen,\nP. O. Brown, D. Botstein, and B. Futcher (1998). ``Comprehensive identification of cell cycle-\nregulated genes of the yeast \\textit{Saccharomyces cerevisiae} by microarray hydrization\".\n\\textit{Molecular Biology of the Cell}, \\textbf{9}, pp. 3273--3279.\n\\end{thebibliography}\n\n\\end{document}\n",
    "created" : 1486878580206.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1039115047",
    "id" : "739E01C0",
    "lastKnownWriteTime" : 1486873381,
    "last_content_update" : 1486873381,
    "path" : "C:/Users/sunze/Desktop/package_0209/vene_0209.Rnw",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "sweave"
}